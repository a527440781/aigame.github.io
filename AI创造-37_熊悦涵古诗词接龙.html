<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤è¯—è¯æ¥é¾™</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=ZCOOL+XiaoWei&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#8B4513',
                        secondary: '#4CAF50',
                        accent: '#FFD700',
                        light: '#F5F5DC',
                        dark: '#5D4037'
                    },
                    fontFamily: {
                        xiaowei: ['"ZCOOL XiaoWei"', 'serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            }
            .pulse {
                animation: pulse 2s infinite;
            }
            @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.05); }
                100% { transform: scale(1); }
            }
            .fade-in {
                animation: fadeIn 0.5s ease-in-out;
            }
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            .slide-up {
                animation: slideUp 0.5s ease-out;
            }
            @keyframes slideUp {
                from { transform: translateY(20px); opacity: 0; }
                to { transform: translateY(0); opacity: 1; }
            }
            .typing {
                animation: typing 1s steps(40, end);
            }
            @keyframes typing {
                from { width: 0 }
                to { width: 100% }
            }
            .correct-answer {
                animation: correctAnswer 0.5s ease-in-out;
            }
            @keyframes correctAnswer {
                0% { transform: scale(1); background-color: white; }
                50% { transform: scale(1.05); background-color: #CCFFCC; }
                100% { transform: scale(1); background-color: white; }
            }
            .wrong-answer {
                animation: wrongAnswer 0.5s ease-in-out;
            }
            @keyframes wrongAnswer {
                0% { transform: scale(1); background-color: white; }
                50% { transform: scale(1.05); background-color: #FFCCCC; }
                100% { transform: scale(1); background-color: white; }
            }
        }
    </style>
</head>
<body class="bg-light font-xiaowei min-h-screen flex flex-col">
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <header class="bg-primary text-white shadow-lg">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <h1 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-shadow flex items-center">
                <i class="fa-solid fa-book-open mr-3"></i>å¤è¯—è¯æ¥é¾™
            </h1>
            <div class="flex space-x-2">
                <button id="helpBtn" class="btn-secondary flex items-center">
                    <i class="fa-solid fa-question-circle mr-2"></i>å¸®åŠ©
                </button>
                <button id="restartBtn" class="btn-secondary flex items-center">
                    <i class="fa-solid fa-refresh mr-2"></i>é‡æ–°å¼€å§‹
                </button>
            </div>
        </div>
    </header>

    <!-- ä¸»å†…å®¹åŒº -->
    <main class="flex-grow container mx-auto px-4 py-6">
        <!-- éš¾åº¦é€‰æ‹©ç•Œé¢ -->
        <section id="difficultySelection" class="text-center fade-in">
            <h2 class="text-[clamp(1.5rem,3vw,2rem)] font-bold text-primary mb-6">é€‰æ‹©éš¾åº¦</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-3xl mx-auto">
                <div class="bg-white rounded-xl shadow-lg p-6 border-2 border-secondary hover:border-primary/70 transition-all duration-300 transform hover:-translate-y-2 cursor-pointer" data-difficulty="easy">
                    <h3 class="text-xl font-bold text-primary mb-2">ç®€å•</h3>
                    <p class="text-dark mb-4">åŸºç¡€è¯—å¥</p>
                    <p class="text-sm text-gray-600">æ¯å¥4-5ä¸ªå­—</p>
                    <div class="mt-4">
                        <i class="fa-solid fa-star text-accent text-2xl"></i>
                        <i class="fa-solid fa-star text-gray-300 text-2xl"></i>
                        <i class="fa-solid fa-star text-gray-300 text-2xl"></i>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6 border-2 border-secondary hover:border-primary/70 transition-all duration-300 transform hover:-translate-y-2 cursor-pointer" data-difficulty="medium">
                    <h3 class="text-xl font-bold text-primary mb-2">ä¸­ç­‰</h3>
                    <p class="text-dark mb-4">è¿›é˜¶è¯—å¥</p>
                    <p class="text-sm text-gray-600">æ¯å¥5-7ä¸ªå­—</p>
                    <div class="mt-4">
                        <i class="fa-solid fa-star text-accent text-2xl"></i>
                        <i class="fa-solid fa-star text-accent text-2xl"></i>
                        <i class="fa-solid fa-star text-gray-300 text-2xl"></i>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6 border-2 border-secondary hover:border-primary/70 transition-all duration-300 transform hover:-translate-y-2 cursor-pointer" data-difficulty="hard">
                    <h3 class="text-xl font-bold text-primary mb-2">å›°éš¾</h3>
                    <p class="text-dark mb-4">é«˜çº§è¯—å¥</p>
                    <p class="text-sm text-gray-600">æ¯å¥7ä¸ªå­—ä»¥ä¸Š</p>
                    <div class="mt-4">
                        <i class="fa-solid fa-star text-accent text-2xl"></i>
                        <i class="fa-solid fa-star text-accent text-2xl"></i>
                        <i class="fa-solid fa-star text-accent text-2xl"></i>
                    </div>
                </div>
            </div>
        </section>

        <!-- æ¸¸æˆç•Œé¢ -->
        <section id="gameSection" class="hidden fade-in">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- å·¦ä¾§ï¼šæ¸¸æˆä¿¡æ¯ -->
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-xl shadow-lg p-4 md:p-6">
                        <h2 class="text-xl font-bold text-primary mb-4">æ¸¸æˆä¿¡æ¯</h2>
                        <div class="space-y-4">
                            <div class="bg-light rounded-lg p-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-dark">å½“å‰éš¾åº¦</span>
                                    <span id="currentDifficulty" class="font-bold text-primary"></span>
                                </div>
                            </div>
                            <div class="bg-light rounded-lg p-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-dark">å½“å‰å¾—åˆ†</span>
                                    <span id="currentScore" class="font-bold text-primary">0</span>
                                </div>
                            </div>
                            <div class="bg-light rounded-lg p-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-dark">è¿ç»­ç­”å¯¹</span>
                                    <span id="streakCount" class="font-bold text-primary">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å³ä¾§ï¼šæ¸¸æˆå†…å®¹ -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 mb-6">
                        <h2 class="text-xl md:text-2xl font-bold text-primary mb-4">æ¥é¾™æŒ‘æˆ˜</h2>
                        
                        <div class="bg-light rounded-lg p-4 mb-6">
                            <span class="text-dark font-bold block mb-2">ä¸Šä¸€å¥ï¼š</span>
                            <div id="previousLine" class="text-[clamp(1.2rem,3vw,1.8rem)] font-bold text-primary text-center"></div>
                        </div>
                        
                        <div class="mb-6">
                            <label for="userAnswer" class="block text-dark font-bold mb-2">è¯·æ¥ä¸‹ä¸€å¥ï¼š</label>
                            <input type="text" id="userAnswer" class="w-full px-4 py-3 rounded-lg border-2 border-primary/30 focus:border-primary focus:outline-none text-lg font-xiaowei" placeholder="è¯·è¾“å…¥ä¸‹ä¸€å¥...">
                        </div>
                        
                        <div class="flex justify-between">
                            <button id="submitBtn" class="btn-primary flex items-center">
                                <i class="fa-solid fa-check mr-2"></i>æäº¤ç­”æ¡ˆ
                            </button>
                            <button id="skipBtn" class="btn-secondary flex items-center">
                                <i class="fa-solid fa-forward mr-2"></i>è·³è¿‡
                            </button>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl shadow-lg p-4 md:p-6">
                        <h2 class="text-xl font-bold text-primary mb-4">æç¤ºä¸åé¦ˆ</h2>
                        <div id="feedback" class="text-gray-700 min-h-[100px]"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- èƒœåˆ©ç•Œé¢ -->
        <section id="victoryScreen" class="hidden text-center fade-in">
            <div class="bg-white rounded-xl shadow-xl p-8 max-w-2xl mx-auto transform transition-all duration-500 pulse">
                <div class="text-6xl mb-4 text-accent">ğŸ‰</div>
                <h2 class="text-3xl font-bold text-primary mb-2">æ­å–œä½ !</h2>
                <p class="text-xl text-dark mb-6">ä½ å·²å®ŒæˆæŒ‘æˆ˜!</p>
                
                <div class="bg-light rounded-lg p-4 mb-6">
                    <p class="font-bold text-lg mb-2">æ¸¸æˆæˆç»©</p>
                    <div class="grid grid-cols-2 gap-4 text-center">
                        <div class="bg-white rounded-lg p-3 shadow">
                            <p class="text-dark">æœ€ç»ˆå¾—åˆ†</p>
                            <p id="finalScore" class="text-2xl font-bold text-primary"></p>
                        </div>
                        <div class="bg-white rounded-lg p-3 shadow">
                            <p class="text-dark">è¿ç»­ç­”å¯¹</p>
                            <p id="finalStreak" class="text-2xl font-bold text-primary"></p>
                        </div>
                    </div>
                </div>
                
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button id="playAgainBtn" class="btn-primary">
                        <i class="fa-solid fa-refresh mr-2"></i>å†ç©ä¸€æ¬¡
                    </button>
                    <button id="changeDifficultyBtn" class="btn-secondary">
                        <i class="fa-solid fa-sliders mr-2"></i>æ›´æ¢éš¾åº¦
                    </button>
                </div>
            </div>
        </section>
    </main>

    <!-- é¡µè„š -->
    <footer class="bg-primary text-white py-4 mt-8">
        <div class="container mx-auto px-4 text-center">
            <p>å¤è¯—è¯æ¥é¾™ Â© 2025 | é€‚åˆäº”å¹´çº§å°å­¦ç”Ÿçš„å­¦ä¹ æ¸¸æˆ</p>
        </div>
    </footer>

    <!-- å¸®åŠ©æ¨¡æ€æ¡† -->
    <div id="helpModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden fade-in">
        <div class="bg-white rounded-xl shadow-2xl p-6 max-w-lg w-full mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-primary">æ¸¸æˆå¸®åŠ©</h3>
                <button id="closeHelpBtn" class="text-gray-500 hover:text-primary">
                    <i class="fa-solid fa-times text-xl"></i>
                </button>
            </div>
            <div class="space-y-4 text-gray-700">
                <div>
                    <h4 class="font-bold text-dark">æ¸¸æˆç›®æ ‡</h4>
                    <p>æ ¹æ®ç»™å‡ºçš„ä¸Šä¸€å¥è¯—è¯ï¼Œæ¥å‡ºä¸‹ä¸€å¥ï¼Œè€ƒéªŒä½ å¯¹å¤è¯—è¯çš„æŒæ¡ç¨‹åº¦ã€‚</p>
                </div>
                <div>
                    <h4 class="font-bold text-dark">å¦‚ä½•ç©</h4>
                    <ol class="list-decimal pl-5 space-y-1">
                        <li>é€‰æ‹©ä¸€ä¸ªéš¾åº¦çº§åˆ«å¼€å§‹æ¸¸æˆ</li>
                        <li>æ ¹æ®æ˜¾ç¤ºçš„ä¸Šä¸€å¥è¯—è¯ï¼Œåœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥ä¸‹ä¸€å¥</li>
                        <li>ç‚¹å‡»"æäº¤ç­”æ¡ˆ"æŒ‰é’®æ£€æŸ¥ä½ çš„å›ç­”</li>
                        <li>å›ç­”æ­£ç¡®ä¼šè·å¾—åˆ†æ•°ï¼Œè¿ç»­ç­”å¯¹ä¼šè·å¾—é¢å¤–å¥–åŠ±</li>
                        <li>å¦‚æœé‡åˆ°å›°éš¾ï¼Œå¯ä»¥ä½¿ç”¨è·³è¿‡åŠŸèƒ½</li>
                    </ol>
                </div>
                <div>
                    <h4 class="font-bold text-dark">æç¤º</h4>
                    <p>æ¯ä¸ªéš¾åº¦çº§åˆ«æœ‰ä¸åŒçš„é¢˜ç›®éš¾åº¦ï¼Œè¿ç»­ç­”å¯¹ä¼šå¢åŠ ä½ çš„å¾—åˆ†å€ç‡ã€‚å°è¯•è®°ä½è¯—è¯çš„ä¸Šä¸‹æ–‡ï¼Œè¿™ä¼šå¸®åŠ©ä½ æ›´å¥½åœ°å®Œæˆæ¥é¾™ã€‚</p>
                </div>
            </div>
            <div class="mt-6 text-center">
                <button id="gotItBtn" class="btn-primary">æˆ‘çŸ¥é“äº†</button>
            </div>
        </div>
    </div>

    <script>
        // è¯—è¯æ•°æ®åº“ï¼ˆç§»é™¤äº†å…³é”®å­—å’Œèµæï¼‰
        const poemsDatabase = {
            easy: [
                {
                    lines: [
                        { previous: "åºŠå‰æ˜æœˆå…‰", next: "ç–‘æ˜¯åœ°ä¸Šéœœ" },
                        { previous: "ç–‘æ˜¯åœ°ä¸Šéœœ", next: "ä¸¾å¤´æœ›æ˜æœˆ" },
                        { previous: "ä¸¾å¤´æœ›æ˜æœˆ", next: "ä½å¤´æ€æ•…ä¹¡" }
                    ]
                },
                {
                    lines: [
                        { previous: "æ˜¥çœ ä¸è§‰æ™“", next: "å¤„å¤„é—»å•¼é¸Ÿ" },
                        { previous: "å¤„å¤„é—»å•¼é¸Ÿ", next: "å¤œæ¥é£é›¨å£°" },
                        { previous: "å¤œæ¥é£é›¨å£°", next: "èŠ±è½çŸ¥å¤šå°‘" }
                    ]
                },
                {
                    lines: [
                        { previous: "ç™½æ—¥ä¾å±±å°½", next: "é»„æ²³å…¥æµ·æµ" },
                        { previous: "é»„æ²³å…¥æµ·æµ", next: "æ¬²ç©·åƒé‡Œç›®" },
                        { previous: "æ¬²ç©·åƒé‡Œç›®", next: "æ›´ä¸Šä¸€å±‚æ¥¼" }
                    ]
                }
            ],
            medium: [
                {
                    lines: [
                        { previous: "æ—¥ç…§é¦™ç‚‰ç”Ÿç´«çƒŸ", next: "é¥çœ‹ç€‘å¸ƒæŒ‚å‰å·" },
                        { previous: "é¥çœ‹ç€‘å¸ƒæŒ‚å‰å·", next: "é£æµç›´ä¸‹ä¸‰åƒå°º" },
                        { previous: "é£æµç›´ä¸‹ä¸‰åƒå°º", next: "ç–‘æ˜¯é“¶æ²³è½ä¹å¤©" }
                    ]
                },
                {
                    lines: [
                        { previous: "æœè¾ç™½å¸å½©äº‘é—´", next: "åƒé‡Œæ±Ÿé™µä¸€æ—¥è¿˜" },
                        { previous: "åƒé‡Œæ±Ÿé™µä¸€æ—¥è¿˜", next: "ä¸¤å²¸çŒ¿å£°å•¼ä¸ä½" },
                        { previous: "ä¸¤å²¸çŒ¿å£°å•¼ä¸ä½", next: "è½»èˆŸå·²è¿‡ä¸‡é‡å±±" }
                    ]
                },
                {
                    lines: [
                        { previous: "å¥½é›¨çŸ¥æ—¶èŠ‚", next: "å½“æ˜¥ä¹ƒå‘ç”Ÿ" },
                        { previous: "éšé£æ½œå…¥å¤œ", next: "æ¶¦ç‰©ç»†æ— å£°" },
                        { previous: "é‡å¾„äº‘ä¿±é»‘", next: "æ±Ÿèˆ¹ç«ç‹¬æ˜" }
                    ]
                }
            ],
            hard: [
                {
                    lines: [
                        { previous: "ä¸ç›¸ç¥ å ‚ä½•å¤„å¯»", next: "é”¦å®˜åŸå¤–æŸæ£®æ£®" },
                        { previous: "æ˜ é˜¶ç¢§è‰è‡ªæ˜¥è‰²", next: "éš”å¶é»„é¹‚ç©ºå¥½éŸ³" },
                        { previous: "ä¸‰é¡¾é¢‘çƒ¦å¤©ä¸‹è®¡", next: "ä¸¤æœå¼€æµè€è‡£å¿ƒ" }
                    ]
                },
                {
                    lines: [
                        { previous: "æ¹–å…‰ç§‹æœˆä¸¤ç›¸å’Œ", next: "æ½­é¢æ— é£é•œæœªç£¨" },
                        { previous: "æ½­é¢æ— é£é•œæœªç£¨", next: "é¥æœ›æ´åº­å±±æ°´ç¿ " },
                        { previous: "é¥æœ›æ´åº­å±±æ°´ç¿ ", next: "ç™½é“¶ç›˜é‡Œä¸€é’èº" }
                    ]
                },
                {
                    lines: [
                        { previous: "ç¦»ç¦»åŸä¸Šè‰", next: "ä¸€å²ä¸€æ¯è£" },
                        { previous: "é‡ç«çƒ§ä¸å°½", next: "æ˜¥é£å¹åˆç”Ÿ" },
                        { previous: "è¿œèŠ³ä¾µå¤é“", next: "æ™´ç¿ æ¥è’åŸ" }
                    ]
                }
            ]
        };

        // æ¸¸æˆçŠ¶æ€
        let gameState = {
            difficulty: null,
            currentPoem: null,
            currentLine: null,
            score: 0,
            streak: 0,
            poemIndex: 0,
            lineIndex: 0
        };

        // DOM å…ƒç´ 
        const difficultySelection = document.getElementById('difficultySelection');
        const gameSection = document.getElementById('gameSection');
        const victoryScreen = document.getElementById('victoryScreen');
        const previousLine = document.getElementById('previousLine');
        const userAnswer = document.getElementById('userAnswer');
        const submitBtn = document.getElementById('submitBtn');
        const skipBtn = document.getElementById('skipBtn');
        const feedback = document.getElementById('feedback');
        const currentDifficulty = document.getElementById('currentDifficulty');
        const currentScore = document.getElementById('currentScore');
        const streakCount = document.getElementById('streakCount');
        const finalScore = document.getElementById('finalScore');
        const finalStreak = document.getElementById('finalStreak');
        const helpBtn = document.getElementById('helpBtn');
        const restartBtn = document.getElementById('restartBtn');
        const playAgainBtn = document.getElementById('playAgainBtn');
        const changeDifficultyBtn = document.getElementById('changeDifficultyBtn');
        const helpModal = document.getElementById('helpModal');
        const closeHelpBtn = document.getElementById('closeHelpBtn');
        const gotItBtn = document.getElementById('gotItBtn');

        // å¼€å§‹æ¸¸æˆ
        function startGame(difficulty) {
            gameState.difficulty = difficulty;
            gameState.score = 0;
            gameState.streak = 0;
            gameState.poemIndex = 0;
            gameState.lineIndex = 0;
            
            // åŠ è½½ç¬¬ä¸€é¦–è¯—
            loadNextPoem();
            
            // æ›´æ–°æ¸¸æˆä¿¡æ¯
            updateGameInfo();
            
            // éšè—éš¾åº¦é€‰æ‹©ï¼Œæ˜¾ç¤ºæ¸¸æˆç•Œé¢
            difficultySelection.classList.add('hidden');
            victoryScreen.classList.add('hidden');
            gameSection.classList.remove('hidden');
            
            // èšç„¦åˆ°è¾“å…¥æ¡†
            userAnswer.focus();
        }

        // åŠ è½½ä¸‹ä¸€é¦–è¯—
        function loadNextPoem() {
            const poems = poemsDatabase[gameState.difficulty];
            if (gameState.poemIndex >= poems.length) {
                // æ‰€æœ‰è¯—éƒ½å®Œæˆäº†ï¼Œæ˜¾ç¤ºèƒœåˆ©ç•Œé¢
                showVictoryScreen();
                return;
            }
            
            gameState.currentPoem = poems[gameState.poemIndex];
            gameState.lineIndex = 0;
            
            // åŠ è½½ç¬¬ä¸€å¥
            loadNextLine();
        }

        // åŠ è½½ä¸‹ä¸€å¥
        function loadNextLine() {
            const lines = gameState.currentPoem.lines;
            if (gameState.lineIndex >= lines.length) {
                // è¿™é¦–è¯—çš„æ‰€æœ‰å¥å­éƒ½å®Œæˆäº†ï¼ŒåŠ è½½ä¸‹ä¸€é¦–
                gameState.poemIndex++;
                loadNextPoem();
                return;
            }
            
            gameState.currentLine = lines[gameState.lineIndex];
            
            // æ˜¾ç¤ºä¸Šä¸€å¥
            previousLine.textContent = gameState.currentLine.previous;
            
            // æ¸…ç©ºè¾“å…¥æ¡†å’Œåé¦ˆ
            userAnswer.value = '';
            feedback.innerHTML = '';
            
            // æ·»åŠ åŠ¨ç”»æ•ˆæœ
            previousLine.classList.add('fade-in');
            
            setTimeout(() => {
                previousLine.classList.remove('fade-in');
            }, 1000);
        }

        // æ›´æ–°æ¸¸æˆä¿¡æ¯
        function updateGameInfo() {
            currentDifficulty.textContent = gameState.difficulty === 'easy' ? 'ç®€å•' : 
                                           gameState.difficulty === 'medium' ? 'ä¸­ç­‰' : 'å›°éš¾';
            currentScore.textContent = gameState.score;
            streakCount.textContent = gameState.streak;
        }

        // æ£€æŸ¥ç­”æ¡ˆ
        function checkAnswer() {
            const answer = userAnswer.value.trim();
            
            if (answer === '') {
                showFeedback('è¯·è¾“å…¥ç­”æ¡ˆï¼', 'warning');
                return;
            }
            
            // ç®€å•çš„ç­”æ¡ˆéªŒè¯ï¼ˆä¸è€ƒè™‘æ ‡ç‚¹ç¬¦å·ï¼‰
            const cleanAnswer = answer.replace(/[ï¼Œã€‚,.]/g, '');
            const cleanCorrectAnswer = gameState.currentLine.next.replace(/[ï¼Œã€‚,.]/g, '');
            
            if (cleanAnswer === cleanCorrectAnswer) {
                // ç­”æ¡ˆæ­£ç¡®
                const basePoints = gameState.difficulty === 'easy' ? 10 : 
                                  gameState.difficulty === 'medium' ? 15 : 20;
                const streakBonus = gameState.streak > 0 ? 0.1 * gameState.streak : 0;
                
                const pointsEarned = Math.round(basePoints * (1 + streakBonus));
                gameState.score += pointsEarned;
                gameState.streak++;
                
                showFeedback(`ç­”å¯¹äº†ï¼+${pointsEarned}åˆ†`, 'correct');
                
                // æ·»åŠ æ­£ç¡®åŠ¨ç”»
                userAnswer.classList.add('correct-answer');
                setTimeout(() => {
                    userAnswer.classList.remove('correct-answer');
                }, 500);
                
                // æ›´æ–°æ¸¸æˆä¿¡æ¯
                updateGameInfo();
                
                // å»¶è¿ŸåŠ è½½ä¸‹ä¸€å¥
                setTimeout(() => {
                    gameState.lineIndex++;
                    loadNextLine();
                }, 1500);
            } else {
                // ç­”æ¡ˆé”™è¯¯
                gameState.streak = 0;
                showFeedback(`ç­”é”™äº†ï¼Œæ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š${gameState.currentLine.next}`, 'wrong');
                
                // æ·»åŠ é”™è¯¯åŠ¨ç”»
                userAnswer.classList.add('wrong-answer');
                setTimeout(() => {
                    userAnswer.classList.remove('wrong-answer');
                }, 500);
                
                // æ›´æ–°æ¸¸æˆä¿¡æ¯
                updateGameInfo();
                
                // å»¶è¿ŸåŠ è½½ä¸‹ä¸€å¥
                setTimeout(() => {
                    gameState.lineIndex++;
                    loadNextLine();
                }, 2000);
            }
        }

        // æ˜¾ç¤ºåé¦ˆ
        function showFeedback(message, type) {
            feedback.innerHTML = '';
            
            const feedbackElement = document.createElement('div');
            feedbackElement.className = `p-3 rounded-lg ${
                type === 'correct' ? 'bg-green-100 text-green-800' : 
                type === 'wrong' ? 'bg-red-100 text-red-800' : 
                'bg-yellow-100 text-yellow-800'
            }`;
            
            feedbackElement.textContent = message;
            feedback.appendChild(feedbackElement);
            
            // æ·»åŠ åŠ¨ç”»æ•ˆæœ
            feedbackElement.classList.add('fade-in');
        }

        // æ˜¾ç¤ºèƒœåˆ©ç•Œé¢
        function showVictoryScreen() {
            finalScore.textContent = gameState.score;
            finalStreak.textContent = gameState.streak;
            
            gameSection.classList.add('hidden');
            victoryScreen.classList.remove('hidden');
        }

        // äº‹ä»¶ç›‘å¬å™¨
        document.querySelectorAll('[data-difficulty]').forEach(button => {
            button.addEventListener('click', () => {
                const difficulty = button.dataset.difficulty;
                startGame(difficulty);
            });
        });

        submitBtn.addEventListener('click', checkAnswer);
        userAnswer.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                checkAnswer();
            }
        });

        skipBtn.addEventListener('click', () => {
            showFeedback(`è·³è¿‡ï¼Œæ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š${gameState.currentLine.next}`, 'info');
            gameState.streak = 0;
            gameState.lineIndex++;
            
            setTimeout(() => {
                loadNextLine();
            }, 1500);
        });

        restartBtn.addEventListener('click', () => {
            if (gameState.difficulty) {
                startGame(gameState.difficulty);
            }
        });

        playAgainBtn.addEventListener('click', () => {
            if (gameState.difficulty) {
                startGame(gameState.difficulty);
            }
        });

        changeDifficultyBtn.addEventListener('click', () => {
            gameState = {
                difficulty: null,
                currentPoem: null,
                currentLine: null,
                score: 0,
                streak: 0,
                poemIndex: 0,
                lineIndex: 0
            };
            victoryScreen.classList.add('hidden');
            difficultySelection.classList.remove('hidden');
        });

        helpBtn.addEventListener('click', () => {
            helpModal.classList.remove('hidden');
        });

        closeHelpBtn.addEventListener('click', () => {
            helpModal.classList.add('hidden');
        });

        gotItBtn.addEventListener('click', () => {
            helpModal.classList.add('hidden');
        });

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        helpModal.addEventListener('click', (e) => {
            if (e.target === helpModal) {
                helpModal.classList.add('hidden');
            }
        });
    </script>
</body>
</html>
    